/*!
 * ----------------------------------------------------------
 *  HTML TEXT EDITOR PLUGIN 1.5.2
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * License: MIT
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://github.com/FortAwesome/Font-Awesome
 * ==========================================================
 * ----------------------------------------------------------
 *
 */
var HTE=function(e,t){function n(e){return void 0!==e}function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function l(e){return"function"==typeof e}function a(e){return"object"==typeof e}function o(e,t,n){return t="on"+t,null===n?e[t]=null:(l(e[t])&&(n=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),void(e[t]=n))}function c(e,t){e=e||{};for(var n in t)e[n]=a(t[n])?c(e[n],t[n]):t[n];return e}function u(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),r=0;return r=et.defaultView&&et.defaultView.getComputedStyle?et.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function s(e,t){return Ct(e,function(){Lt(t.end+1,!0)}),!1}function f(e){return e.replace(/^\s+|\s+$/g,"")}function p(e){return e.replace(/^\s+/,"")}function d(e){return e.replace(/\s+$/,"")}function g(e){return e.replace(tt.escape,"\\$1")}function h(e){return e.parentNode}function m(e){return{w:e.offsetWidth,h:e.offsetHeight}}function v(e){return{l:e.offsetLeft,t:e.offsetTop}}function x(e){return et.createElement(e)}function b(e,t){var n,r=Rt(),i=e,l=St.LI,a=i.split(" ")[0],o=l.split(" ")[0];if(r.value.length){var c=/([\s\S]*?)<(?:ol|ul)(>| .*?>)([\s\S]*?)<\/(?:ol|ul)>([\s\S]*?)/g;r.value==t?Lt():r.value.match(c)?yt(c,"$1<"+a+"$2$3</"+a+">$4"):At(xt,function(){Ct("<"+i+">\n"+St.tabSize+"<"+l+">"+r.value.replace(/\n/g,"</"+o+">\n"+St.tabSize+"<"+l+">").replace(RegExp("\\n("+St.tabSize+")?<"+l+"><\\/"+o+">\\n","g"),"\n</"+a+">\n\n<"+i+">\n")+"</"+o+">\n</"+a+">")},xt,!0)}else if(r.after.match(RegExp("^<\\/"+o+">"))){var u=/(?:^|\n)([\t ]*).*?$/.exec(r.before),s=u?u[1]:"";Ct("\n"+s+St.tabSize+"<"+i+">\n"+s+St.tabSize+St.tabSize+"<"+l+">"+t+"</"+o+">\n"+s+St.tabSize+"</"+a+">\n"+s,function(){n=Rt().end-(a+St.tabSize+o+s+s).length-8,Lt(n-t.length,n,!0)})}else r.before.match(/<\/(?:ol|ul)>\s?$/)?(kt.value=r.before.replace(/<(?:ol|ul)(>| .*?>)([\s\S]*?)<\/(?:ol|ul)>(\s?)$/g,"<"+a+"$1$2</"+a+">$3")+r.after,Lt(r.end,!0)):At(xt,function(){Ct("<"+i+">\n"+St.tabSize+"<"+l+">"+t+"</"+o+">\n</"+a+">",function(){r=Rt(),n=r.end-(a+o).length-7,Lt(n-t.length,n,!0)})},xt,!0)}var k="\u2018",$="\u2019",C="\u201C",E="\u201D",w="\u2013",y="\u2014",L="\u2026",R="\u00A6",T="\u00A9",O="\u2117",_="\u2120",S="\u2122",H="\u00AE",M="\u00B1",N="\u00D7",I="\u00F7",B="\u00B0",A="\u2039",z="\u203A",U="\u00AB",P="\u00BB",K="\u2264",D="\u2265",Y="\u2260",q="\u2190",Q="\u2192",F="\u2191",G="\u2193",V="\u21B5",X="\u2318",W="\u00B7",j="\u2116",J=this,Z=window,et=document,tt=new Editor(e),nt=function(){},rt={tabSize:"    ",toolbar:!0,shortcut:!1,dir:"ltr",areaClass:"editor-area",toolbarClass:"editor-toolbar",toolbarIconClass:"fa fa-%s",toolbarButtonClass:"editor-toolbar-button editor-toolbar-button-%s",toolbarSeparatorClass:"editor-toolbar-separator",toolbarPosition:"before",dropClass:"custom-drop custom-drop-%s",modalClass:"custom-modal custom-modal-%s",modalHeaderClass:"custom-modal-header custom-modal-%s-header",modalContentClass:"custom-modal-content custom-modal-%s-content",modalFooterClass:"custom-modal-footer custom-modal-%s-footer",modalOverlayClass:"custom-modal-overlay custom-modal-%s-overlay",autoComplete:!0,autoIndent:!0,emptyElementSuffix:">",autoEncodeHTML:!0,P:"p",BR:"br",H_:"h%d",STRONG:"strong",EM:"em",U:"u",STRIKE:'del datetime="%Y-%m-%d"',UL:"ul",OL:"ol",LI:"li",HR:"hr",Q:"q",BLOCKQUOTE:"blockquote",CODE:"code",PRE:"pre",SUB:"sub",SUP:"sup",A:"a",IMG:"img",FIGURE:"figure",FIGCAPTION:"figcaption",actions:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No",open:"Open",close:"Close"},buttons:{bold:["Bold",X+"+B"],italic:["Italic",X+"+I"],underline:["Underline",X+"+U"],strike:["Strike",X+"+Delete"],superscript:["Superscript",X+"+"+F],subscript:["Subscript",X+"+"+G],code:["Code",X+"+K"],paragraph:["Paragraph",X+"+"+V],quote:["Quote",X+"+Q"],heading:["H1 "+w+" H6",X+"+H"],link:["Link",X+"+L"],image:["Image",X+"+G"],ol:["Ordered List",X+"++"],ul:["Unordered List",X+"+-"],rule:["Horizontal Rule",X+"+R"],undo:["Undo",X+"+Z"],redo:["Redo",X+"+Y"]},placeholders:{text:"text goes here"+L,heading_text:"Heading",link_text:"link text",list_ul_text:"List item",list_ol_text:"List item",image_alt:"Image"},prompts:{link_title:"link title goes here"+L,link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_title:"image caption goes here"+L,image_title_title:"Image Caption",image_url:"http://",image_url_title:"Image URL"},update:nt,keydown:nt,click:nt,ready:nt,copy:nt,cut:nt,paste:nt},it=et.body,lt=et.documentElement,at=x("div"),ot=x("div"),ct=x("div"),ut=0,st=null,ft=null,pt=0,dt=0,gt=0,ht=0,mt=m(lt).w,vt=Math.max(Z.innerHeight,m(lt).h),xt="\n\n",bt=" ",kt=e,$t=tt.indent,Ct=tt.insert,Et=tt.key,wt=tt.outdent,yt=tt.replace,Lt=tt.select,Rt=tt.selection,Tt=tt.updateHistory,Ot=tt.wrap,_t=Z.setTimeout,St=c(rt,t),Ht=x("span");J.config=JSON.parse(JSON.stringify(St)),J.DOM={overlay:at,modal:ot,drop:ct};{var Mt=(g(St.UL).replace(/\\[-+*]/g,"[-+*]"),g(St.OL).replace(/%d/g,"\\d+"),g(St.tabSize));g(St.PRE),g(St.BLOCKQUOTE)}J.shortcuts=[],J.shortcut=function(e,t){J.shortcuts[e.toLowerCase()]=t,J.shortcuts=function(){for(var e=Object.keys(J.shortcuts).sort().reverse(),t={},n=0,r=e.length;r>n;++n)t[e[n]]=J.shortcuts[e[n]];return t}()},J.event=function(e,t,n){return o(t,e,n)},J.modal=function(e,t,n){l(e)&&(n=t,t=e,e="default"),e=e||"default",n=n||{},ut=it.scrollTop||lt.scrollTop,at.className=St.modalOverlayClass.replace(/%s/g,e),ot.className=St.modalClass.replace(/%s/g,e),ot.innerHTML='<div class="'+St.modalHeaderClass.replace(/%s/g,e)+'"></div><div class="'+St.modalContentClass.replace(/%s/g,e)+'"></div><div class="'+St.modalFooterClass.replace(/%s/g,e)+'"></div>';var r=ot.style,i="left"in n,a="top"in n;r.visibility="hidden",_t(function(){it.appendChild(at),it.appendChild(ot)},.1),_t(function(){var e=m(ot).w,t=m(ot).h;r.position="absolute",r.left=i?n.left+"px":"50%",r.top=a?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(i?0:0-e/2)+"px",r.marginTop=(a?0:ut-t/2)+"px",r.visibility="",v(ot).l<0&&!i&&(r.left=0,r.marginLeft=0,i=!0,n.left=0),v(ot).t<0&&!a&&(r.top=0,r.marginTop=0,a=!0,n.top=0);var l=ot.children[0];o(l,"mousedown",function(){return ft=ot,gt=pt-v(ft).l,ht=dt-v(ft).t,!1}),o(it,"mousemove",null),o(it,"mousemove",function(n){pt=n.pageX,dt=n.pageY+ut;var l,o,c=i?0:e/2,u=a?0:t/2;if(null!==ft){var s=i?e:0,f=a?t:0;l=pt-gt+c,o=dt-ht+u,c>l&&(l=c),u>o&&(o=u),l+c+s>mt&&(l=mt-c-s),o+u+f>vt&&(o=vt-u-f),r.left=l+"px",r.top=o-ut+"px"}})},.2);var c=ot.children;l(t)&&t(at,ot,c[0],c[1],c[2])},J.drop=function(e,t,n){l(e)&&(n=t,t=e,e="default"),!n&&st&&(n={left:v(st).l,top:v(st).t+m(st).h}),e=e||"default",n=n||{},ut=it.scrollTop||lt.scrollTop,ct.className=St.dropClass.replace(/%s/g,e);var r=ct.style,i="left"in n,a="top"in n;r.visibility="hidden",_t(function(){it.appendChild(ct)},.1),_t(function(){var e=m(ct).w,t=m(ct).h;r.position="absolute",r.left=i?n.left+"px":"50%",r.top=a?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(i?0:0-e/2)+"px",r.marginTop=(a?0:ut-t/2)+"px",r.visibility="",n.left+e>mt&&(r.left=mt-e+"px",r.marginLeft=0),n.top+t>vt&&(r.top=vt-t+"px",r.marginTop=0)},.2),l(t)&&t(ct)},J.prompt=function(e,t,n,r,i){J.modal("prompt",function(i,a,c,u,s){var f=function(e){l(r)?(J.exit(),r(e)):J.exit(!0)},p=x("input");p.type="text",p.value=t,o(p,"keydown",function(e){var r=Et(e);if("escape"==r)return J.exit(!0),!1;if("arrowdown"==r)return d.focus(),!1;if(n){if("enter"==r&&""!==this.value&&this.value!==t)return f(this.value),!1}else if("enter"==r)return f(this.value==t?"":this.value),!1});var d=x("button");d.innerHTML=St.actions.ok,o(d,"click",function(){return n?""!==p.value&&p.value!==t&&f(p.value):f(p.value==t?"":p.value),!1});var g=x("button");g.innerHTML=St.actions.cancel,o(g,"click",function(){return J.exit(!0),!1}),o(d,"keydown",function(e){var t=Et(e);return"escape"==t?(J.exit(!0),!1):"arrowup"==t?(p.focus(),!1):"arrowright"==t?(g.focus(),!1):t.match(/^arrow(left|down)$/)?!1:void 0}),o(g,"keydown",function(e){var t=Et(e);return"escape"==t?(J.exit(!0),!1):"arrowup"==t?(p.focus(),!1):"arrowleft"==t?(d.focus(),!1):t.match(/^arrow(right|down)$/)?!1:void 0}),c.innerHTML=e?e:"",u.appendChild(p),s.appendChild(d),s.appendChild(et.createTextNode(" ")),s.appendChild(g),_t(function(){p.select()},.2)},i)},J.alert=function(e,t,n,r){J.modal("alert",function(r,i,a,c,u){var s=x("button");s.innerHTML=St.actions.ok,o(s,"click",function(){return l(n)?(J.exit(),n()):J.exit(!0),!1}),o(s,"keydown",function(e){return Et(e,"escape")?(J.exit(!0),!1):void 0}),a.innerHTML=e?e:"",c.innerHTML=t?t:"",u.appendChild(s),_t(function(){s.focus()},.2)},r)},J.confirm=function(e,t,r,i){J.modal("confirm",function(i,a,c,u,s){var f=x("button");f.innerHTML=St.actions.ok,o(f,"click",function(){return n(r)&&l(r.OK)?(J.exit(),r.OK()):J.exit(!0),!1});var p=x("button");p.innerHTML=St.actions.cancel,o(p,"click",function(){return n(r)&&l(r.CANCEL)?(J.exit(),r.CANCEL()):J.exit(!0),!1}),o(f,"keydown",function(e){var t=Et(e);return"escape"==t?(J.exit(!0),!1):"arrowright"==t?(p.focus(),!1):t.match(/^arrow(left|down)$/)?!1:void 0}),o(p,"keydown",function(e){var t=Et(e);return"escape"==t?(J.exit(!0),!1):"arrowleft"==t?(f.focus(),!1):t.match(/^arrow(right|down)$/)?!1:void 0}),c.innerHTML=e?e:"",u.innerHTML=t?t:"",s.appendChild(f),s.appendChild(et.createTextNode(" ")),s.appendChild(p),_t(function(){p.focus()},.2)},i)},J.exit=J.close=function(e){if(st=null,ft=null,h(at)&&it.removeChild(at),h(ot)&&it.removeChild(ot),h(ct)&&it.removeChild(ct),e&&e!==!1){var t=Rt();a(e)||(e={}),Lt("start"in e?e.start:t.start,"end"in e?e.end:t.end)}},o(Z,"resize",function(){mt=m(lt).w,vt=Math.max(Z.innerHeight,m(lt).h)}),o(it,"mouseup",function(){ft=null}),o(at,"click",function(){J.exit(!0)}),J.scroll=function(e,t){i(e)?kt.scrollTop=e:kt.scrollTop+=parseInt(u(kt,"line-height"),10),l(t)&&t()},J.time=function(e){var t=new Date,r=t.getFullYear(),i=t.getMonth()+1,l=t.getDate(),a=t.getHours(),o=t.getMinutes(),c=t.getSeconds(),u=t.getMilliseconds();10>i&&(i="0"+i),10>l&&(l="0"+l),10>a&&(a="0"+a),10>o&&(o="0"+o),10>c&&(c="0"+c),10>u&&(u="0"+u);var s={Y:""+r,m:""+i,d:""+l,H:""+a,i:""+o,s:""+c,u:""+u};return n(e)?s[e]:s},St.toolbar&&(Ht.className=St.toolbarClass,o(Ht,"click",function(){return J.exit(!1),!1}),kt.parentNode.insertBefore(Ht,St.toolbarPosition.match(/^after|bottom$/i)?null:kt));var Nt=x("a");Nt.href="#esc:"+(new Date).getTime(),Nt.style.width=0,Nt.style.height=0,kt.parentNode.appendChild(Nt),J.button=function(e,t){if("|"===e)return J.separator(t);if(t=t||{},t.title!==!1){a(t.title)||(t.title=[t.title]);var n,c=x("a");if(c.className=St.toolbarButtonClass.replace(/%s/g,e),c.setAttribute("dir",t.dir||St.dir),c.setAttribute("tabindex",-1),c.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),c.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+St.toolbarIconClass.replace(/%s/g,e)+'"></i>',t.title[0]&&(c.title=t.title[0]),t.title[1]&&(c.title+=" ("+t.title[1]+")"),a(t.attr))for(var u in t.attr)if(r(t.attr[u])&&"+="==t.attr[u].slice(0,2)){var s=c.getAttribute(u)||"";c.setAttribute(u,s+t.attr[u].slice(2))}else c.setAttribute(u,t.attr[u]);o(c,"click",function(e){if(l(t.click)){var n=this.hash.replace("#","");return st=c,t.click(e,J),St.click(e,J,n),St.update(e,J,n),!1}}),o(c,"keydown",function(e){return Et(e,"escape")?(J.exit(!0),!1):void 0}),i(t.position)?(n=t.position<0?t.position+Ht.children.length+1:t.position-1,Ht.insertBefore(c,Ht.children[n]||null)):Ht.appendChild(c),rt.buttons[e]=t}},J.separator=function(e){e=e||{};var t,n=x("span");if(n.className=St.toolbarSeparatorClass,a(e.attr))for(var l in e.attr)if(r(e.attr[l])&&"+="==e.attr[l].slice(0,2)){var o=n.getAttribute(l)||"";n.setAttribute(l,o+e.attr[l].slice(2))}else n.setAttribute(l,e.attr[l]);i(e.position)?(t=e.position<0?e.position+Ht.children.length+1:e.position-1,Ht.insertBefore(n,Ht.children[t]||null)):Ht.appendChild(n)},tt.tidy=function(e,t,r,i){r=n(r)?r:e;var a,o=Rt(),c=-1===e.indexOf("\n")&&o.before.match(/\n$/),u=-1===r.indexOf("\n")&&o.after.match(/^\n/),s=c?o.before:d(o.before),g=f(o.value),h=u?o.after:p(o.after),m=s.length&&!c?e:"",v=h.length&&!u?r:"";return o.value.length&&!i&&l(t)?t(o):(kt.value=s+m+g+v+h,a=s.length+m.length,Lt(a,a+g.length),void(l(t)&&t(Rt())))},tt.toggle=function(e,t,n,r){var i=Rt();if(i.before.slice(-e.length)!=e&&i.after.slice(0,t.length)!=t)Ot(e,t,!i.value.length&&r?function(){yt(/^/,r===!0?St.placeholders.text:r,n)}:!0);else{var l=i.before.slice(-e.length)==e?i.before.slice(0,-e.length):i.before,a=i.after.slice(0,t.length)==t?i.after.slice(t.length):i.after;kt.value=l+i.value+a,Lt(l.length,(l+i.value).length,n||!0)}};var It=0,Bt=St.buttons,At=tt.tidy,zt=tt.toggle,Ut={bold:{title:Bt.bold,click:function(){var e=St.STRONG;At(bt,function(){zt("<"+e+">","</"+e.split(" ")[0]+">",!0,!0)})}},italic:{title:Bt.italic,click:function(){var e=St.EM;At(bt,function(){zt("<"+e+">","</"+e.split(" ")[0]+">",!0,!0)})}},underline:{title:Bt.underline,click:function(){var e=St.U;At(bt,function(){zt("<"+e+">","</"+e.split(" ")[0]+">",!0,!0)})}},strikethrough:{title:Bt.strike,click:function(){var e=J.time(),t=St.STRIKE;t=t.replace(/%Y/g,e.Y).replace(/%m/g,e.m).replace(/%d/g,e.d).replace(/%H/g,e.H).replace(/%i/g,e.i).replace(/%s/g,e.s).replace(/%u/g,e.u),At(bt,function(){zt("<"+t+">","</"+t.split(" ")[0]+">",!0,!0)})}},paragraph:{title:Bt.paragraph,click:function(){var e=Rt(),t=St.P,n=t.split(" ")[0],r=g(n),i=St.placeholders.text;if(e.value.length)e.value==i?Lt():RegExp("^<"+r+"(>| .*?>)|<\\/"+r+">$").test(e.value)?yt(RegExp("<"+r+"(>| .*?>)([\\s\\S]*?)<\\/"+r+">","g"),"$2"):(yt(/^/,"<"+t+">",nt),yt(/$/,"</"+n+">",nt),yt(/\n/g,"</"+n+">\n<"+t+">",nt),yt(RegExp("<"+r+"(>| .*?>)<\\/"+r+">","g"),"",nt),yt(RegExp("(<"+r+"(>| .*?>))+","g"),"$1",nt),yt(RegExp("(<\\/"+r+">)+","g"),"$1"));else if(e.after.match(RegExp("^<\\/"+n+">")))Ot("</"+n+">\n<"+t+">","",function(){yt(/^/,i)},!0);else{var l=!e.before.match(RegExp("<\\/"+n+">\\s*$")),a=!e.after.match(RegExp("^\\s*<"+n+"(>| .*?>)"));At(l?xt:"\n",function(){zt("<"+t+">","</"+n+">",!0,!0)},a?xt:"\n",!0)}}},"quote-right":{title:Bt.quote,click:function(){var e=Rt(),t=St.Q,n=St.BLOCKQUOTE;e.before.match(/(^|\n)$/)?At(xt,function(){zt("<"+n+">\n","\n</"+n.split(" ")[0]+">",!0,!0)},xt,!e.before.match(/\n$/)):At(bt,function(){t=e.before.match(RegExp("<"+n.split(" ")[0]+"(>| .*?>)$"))?n:t,zt("<"+t+">","</"+t.split(" ")[0]+">",!0,!0)})}},code:{title:Bt.code,click:function(){var e=Rt(),t=St.CODE,n=St.PRE,r=t.split(" ")[0],i=n.split(" ")[0],l=!e.before.match(/(^|\n)$/),a=l?bt:xt,o=l?"<"+t+">":"<"+n+"><"+t+">",c=l?"</"+r+">":"</"+r+"></"+i+">";if(At(a,nt,a,!l),e.value.length){var e=Rt(),u=e.before,s=e.value,f=e.after,p=g(r),d=g(i);u.match(RegExp("(<"+d+"(>| .*?>))?<"+p+"(>| .*?>)s*$"))&&f.match(RegExp("^s*<\\/"+p+">(<\\/"+d+">)?"))?(u=u.replace(RegExp("(<"+d+"(>| .*?>))?<"+p+"(>| .*?>)$"),""),f=f.replace(RegExp("^<\\/"+p+">(<\\/"+d+">)?"),""),St.autoEncodeHTML&&(s=s.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")),kt.value=u+s+f,Lt(u.length,(u+s).length,!0)):(St.autoEncodeHTML&&(s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),kt.value=u+o+s+c+f,Lt((u+o).length,(u+s+o).length,!0))}else zt(o,c,!0,!0)}},header:{title:Bt.heading,click:function(){var e,t,n,r=Rt(),i=St.H_,l=i.split(" ")[0],a=g(l).replace(/%d/g,"[1-6]"),o=St.P,c=o.split(" ")[0],u=g(c),s="<\\/?(?:"+a+"|"+u+")(>| .*?>)",h=d(r.before.replace(RegExp(s+"$"),"")),m=f(r.value.replace(RegExp("^"+s+"|"+s+"$","g"),"").replace(/\n+/g," ")),v=p(r.after.replace(RegExp("^"+s),"")),x=h.length?xt:"",b=v.length?xt:"",k=r.value.match(RegExp("^"+s))?RegExp("^"+s).exec(r.value):RegExp(s+"$").exec(r.before);if(k=k?k[1]:">",It=6>It?It+1:0,r.value.length)r.before.match(RegExp(s+"$"))?(n=l.replace(/%d/g,It),kt.value=h+x+"<"+(It>0?n:c)+k+m+"</"+(It>0?n:c)+">"+b+v,e=(h+x+k+(It>0?n:c)).length+1):(t=i.replace(/%d/g,It),n=l.replace(/%d/g,It),kt.value=h+x+"<"+(It>0?t:o)+k+m+"</"+(It>0?n:c)+">"+b+v,e=h.length+x.length+1+(It>0?t.length:o.length)+k.length),Lt(e,e+m.length,!0);else{var $=St.placeholders.heading_text;i=i.replace(/%d/g,1),l=l.replace(/%d/g,1),It=1,kt.value=d(r.before)+x+"<"+i+">"+$+"</"+l+">"+b+v,e=(d(r.before)+x+i).length+2,Lt(e,e+$.length,!0)}}},link:{title:Bt.link,click:function(e){var t,n,r=Rt(),i=St.A,l=i.split(" ")[0],a=St.placeholders.link_text;Tt(),J.prompt(St.prompts.link_url_title,St.prompts.link_url,!0,function(o){n=o;var c,u;-1!==n.indexOf("://")&&(c=!0),""!==Z.location.host&&-1!==n.indexOf("://"+Z.location.host)&&(c=!1),J.prompt(St.prompts.link_title_title,St.prompts.link_title,!1,function(o){u=c?' rel="nofollow" target="_blank"':"",At(bt,function(){t=o.replace(/'/g,"&apos;").replace(/"/g,"&quot;"),Ot("<"+i+' href="'+n+'"'+(""!==t?' title="'+t+'"':"")+u+">","</"+l+">",r.value.length?!0:function(){yt(/^/,a)})}),St.update(e,J)})})}},image:{title:Bt.image,click:function(e){var t,n;Tt(),J.prompt(St.prompts.image_url_title,St.prompts.image_url,!0,function(r){t=r,J.prompt(St.prompts.image_title_title,St.prompts.image_title,!1,function(r){n=r,At(xt,function(){var e=Rt(),r=f(e.value.length?e.value:decodeURIComponent(t.split("/").pop().replace(/\..*$/,"").replace(/[-+._]/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()}));r.length||(r=St.placeholders.image_alt);var i="",l="",a=St.FIGURE,o=St.FIGCAPTION;""!==n&&(i="<"+a+">\n"+St.tabSize,l="\n"+St.tabSize+"<"+o+">"+n+"</"+o.split(" ")[0]+">\n</"+a.split(" ")[0]+">"),Ct(i+"<"+St.IMG+' alt="'+r+'" src="'+t+'"'+St.emptyElementSuffix+l,function(){e=Rt(),e.after.length||(kt.value+=xt),Lt(e.end+2,!0)})},xt,!0),St.update(e,J)})})}},"list-ol":{title:Bt.ol,click:function(){b(St.OL,St.placeholders.list_ol_text)}},"list-ul":{title:Bt.ul,click:function(){b(St.UL,St.placeholders.list_ul_text)}},superscript:{title:Bt.superscript,click:function(){var e=St.SUP;At(bt,function(){zt("<"+e+">","</"+e.split(" ")[0]+">",!0,!0)})}},subscript:{title:Bt.subscript,click:function(){var e=St.SUB;At(bt,function(){zt("<"+e+">","</"+e.split(" ")[0]+">",!0,!0)})}},"ellipsis-h":{title:Bt.rule,click:function(){At(xt,function(){Ct("<"+St.HR+St.emptyElementSuffix,function(){var e=Rt();e.after.length||(kt.value+=xt),Lt(e.end+2,!0)})})}},undo:{title:Bt.undo,click:tt.undo},repeat:{title:Bt.redo,click:tt.redo}};for(var Pt in Ut)J.button(Pt,Ut[Pt]);o(kt,"focus",J.exit),o(kt,"copy",function(e){var t=Rt();_t(function(){St.copy(t),St.update(e,J)},.1)}),o(kt,"cut",function(e){var t=Rt();_t(function(){t.end=t.start,St.cut(t),St.update(e,J),Tt()},.1)}),o(kt,"paste",function(e){var t=Rt();_t(function(){t.end=Rt().end,t.value=kt.value.substring(t.start,t.end),St.paste(t),St.update(e,J),Tt()},.1)}),o(kt,"keydown",function(e){var t=Rt(),n=t.before,r=t.value,i=t.after,l=t.start,a=t.end,o=Et(e),c=e.ctrlKey,u=e.shiftKey,f=e.altKey,p="tab"==o;_t(function(){St.keydown(e,J),St.update(e,J)},.1);for(var d in J.shortcuts){var h=d.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split(/\n/),m=0;for(var v in h)(h[v].match(/^ctrl|control|command|cmd|meta$/)&&c||"shift"==h[v]&&u||h[v].match(/^alt(ernate)?|option$/)&&f||"tab"==h[v]&&p||h[v]==o)&&m++;if(m===h.length)return J.shortcuts[d](e,J)}var x=n,b=i[0],X="\\"==x.slice(-1);if(St.autoComplete&&!X){if(o==b&&(-1!==x.indexOf("(")&&")"==b||-1!==x.indexOf("{")&&"}"==b||-1!==x.indexOf("[")&&"]"==b||-1!==x.indexOf("<")&&">"==b||-1!==x.indexOf('"')&&'"'==b||-1!==x.indexOf("'")&&"'"==b||-1!==x.indexOf("`")&&"`"==b))return Lt(a+1),!1;if("("==o)return s("("+r+")",t);if("{"==o)return s("{"+r+"}",t);if("["==o)return s("["+r+"]",t);if("<"==o)return s("<"+r+">",t);if('"'==o)return s('"'+r+'"',t);if(!n.match(/\w$/)){if("'"==o)return s("'"+r+"'",t);if("`"==o)return s("`"+r+"`",t)}}if(u&&p)return wt(St.tabSize),!1;if(p){if(n.match(/<[^\/>]*?$/)&&">"==i[0]){var Z=/<([^\/>]*?)$/.exec(n),et=Z[1].split(" ")[0];return kt.value=et.match(/^br|hr|img|input|link|meta$/)?n+" "+St.emptyElementSuffix+i.substring(1):n+" ></"+et+i,Lt(l+1,!0),!1}return $t(St.tabSize),!1}if(c&&"z"==o)return tt.undo(),!1;if(c&&"y"==o)return tt.redo(),!1;if(St.toolbar&&St.shortcut&&c){if("b"==o)return Ut.bold.click(),!1;if("g"==o)return Ut.image.click(),!1;if("h"==o)return Ut.header.click(),!1;if("i"==o)return Ut.italic.click(),!1;if(!u&&"k"==o)return Ut.code.click(),!1;if("l"==o)return Ut.link.click(),!1;if("q"==o)return Ut["quote-right"].click(),!1;if("r"==o)return Ut["ellipsis-h"].click(),!1;if("u"==o)return Ut.underline.click(),!1;if(r.length&&"delete"==o)return Ut.strikethrough.click(),!1;if("+"==o)return Ut["list-ol"].click(),!1;if("-"==o)return Ut["list-ul"].click(),!1;if("arrowup"==o)return Ut.superscript.click(),!1;if("arrowdown"==o)return Ut.subscript.click(),!1}if("enter"==o){if(f&&!r.length)return Ct(V),!1;if(St.toolbar&&c)return Ut.paragraph.click(),!1;if(St.toolbar&&u)return Ct("<"+St.BR+St.emptyElementSuffix+"\n"),J.scroll(),!1;if(St.toolbar){var rt=St.LI.split(" ")[0],it=g(rt);if(n.match(RegExp("<\\/"+it+">$"))){var Z=RegExp("(?:^|\\n)([\\t ]*)<"+it+"(>| .*?>).*?<\\/"+it+">$").exec(n);return Ct("\n"+Z[1]+"<"+rt+Z[2]+"</"+rt+">",function(){Lt(a+(Z[1]+Z[2]).length+4,!0)}),J.scroll(),!1}if(i.match(RegExp("^<\\/"+it+">"))&&">"!=n.slice(-1)){var Z=RegExp("(?:^|\\n)([\\t ]*)<"+it+"(>| .*?>).*$").exec(n);return Ct("</"+rt+">\n"+Z[1]+"<"+rt+Z[2]),J.scroll(),!1}var lt=St.P.split(" ")[0],at=g(lt);if(i.match(RegExp("^<\\/"+at+">"))){var Z=RegExp("(?:^|\\n?)([\\t ]*)<"+at+"(>| .*?>).*$").exec(n);return Ct("</"+lt+">\n"+Z[1]+"<"+lt+Z[2]),J.scroll(),!1}}if(St.autoIndent){var ot=RegExp("(?:^|\\n)(("+Mt+")+)(.*?)$").exec(n),ct=ot?ot[1]:"";if(n.match(/[\(\{\[]$/)&&i.match(/^[\]\}\)]/)||n.match(/<[^\/]*?>$/)&&i.match(/^<\//))return Ct("\n"+ct+Mt+"\n"+ct,function(){Lt(l+(ct+St.tabSize).length+1,!0)}),J.scroll(),!1;if(n.match(RegExp(Mt+".*?$")))return Ct("\n"+ct),J.scroll(),!1}}var ut={"'":$,'"':E,"---":y,"--":w,"...":L,"|":R,"(c)":T,"(C)":T,"(p)":O,"(P)":O,"(sm)":_,"(SM)":_," sm":_," SM":_,"(tm)":S,"(TM)":S," tm":S," TM":S,"(r)":H,"(R)":H,"+-":M,"-+":M,x:N,"/":I,"^":B,"<<":U,">>":P,"<":A,">":z,"<=":K,">=":D,"!=":Y,"No.":j,"NO.":j,"no.":j,".":W};if(r.length){if(f){yt(/'([^']*?)'/g,k+"$1"+$,nt),yt(/"([^"]*?)"/g,C+"$1"+E,nt);for(var d in ut)yt(RegExp(g(d),"g"),ut[d],nt);return Tt(),!1}}else{if(f){if(-1!==n.indexOf('"')&&'"'==i[0])return kt.value=n.replace(/"([^"]*?)$/,C+"$1")+E+i.slice(1),Lt(a,!0),!1;if(-1!==n.indexOf("'")&&"'"==i[0])return kt.value=n.replace(/'([^']*?)$/,k+"$1")+$+i.slice(1),Lt(a,!0),!1;if(n.slice(-2).match(/\w'$/i))return kt.value=n.slice(0,-1)+$+i,Lt(a,!0),!1;if(n.slice(-2).match(/(^|\W)'$/i))return kt.value=n.slice(0,-1)+k+i,Lt(a,!0),!1;if(n.match(/\((c|p|sm|tm|r)$/i)&&")"==i[0]){var st=n.match(/\((sm|tm)$/i)?2:1;return kt.value=n.slice(0,-(st+1))+ut["("+n.slice(-st).toLowerCase()+")"]+i.slice(1),Lt(a-st,!0),!1}var ft=n.replace(/&lt;/g,"<").replace(/&gt;/g,">"),pt=i.replace(/&lt;/g,"<").replace(/&gt;/g,">");if(-1!==ft.indexOf("<<")&&0===pt.indexOf(">>"))return kt.value=n.replace(/(?:<<|&lt;&lt;)([^<]*)$/,U+"$1")+i.replace(/^(?:>>|&gt;&gt;)/,P),Lt(ft.length-1,!0),!1;if(-1!==ft.indexOf("<")&&0===pt.indexOf(">"))return kt.value=n.replace(/(?:<|&lt;)([^<]*)$/,A+"$1")+i.replace(/^(?:>|&gt;)/,z),Lt(ft.length,!0),!1;for(var d in ut)if(n.slice(-d.length)==d)return kt.value=n.slice(0,-d.length)+ut[d]+i,Lt(l-d.length+1,!0),!1;if("arrowleft"==o)return Ct(q),!1;if("arrowup"==o)return Ct(F),!1;if("arrowright"==o)return Ct(Q),!1;if("arrowdown"==o)return Ct(G),!1}if("delete"==o&&i.match(/^<\/[^\n>]*?>/))return kt.value=n+i.replace(/^<\/[^\n>]*?>/,""),Lt(l,!0),!1;if("backspace"==o){if(n.match(RegExp("(^|\\n)("+Mt+")+$")))return wt(St.tabSize),!1;if(n.match(/<\/?[^\n>]*?>$/))return wt("<\\/?[^\\n>]*?>",!0,!0),!1;switch(n.slice(-1)){case"(":return zt("(",")"),!1;case"{":return zt("{","}"),!1;case"[":return zt("[","]"),!1;case"<":return zt("<",">"),!1;case'"':return zt('"','"'),!1;case"'":return zt("'","'"),!1;case" ":return zt(" "," "),!1;case C:return zt(C,E),!1;case k:return zt(k,$),!1;case U:return zt(U,P),!1;case A:return zt(A,z),!1}}}return"escape"==o?(Nt.focus(),!1):void(c||u||f||_t(Tt,.1))});var Kt=RegExp("(^|\\s)"+St.areaClass+"(\\s|$)"),Dt=kt.className;Dt.match(Kt)||(kt.className=f(Dt+" "+St.areaClass)),St.ready(J),J.grip=tt,J.grip.config=St};